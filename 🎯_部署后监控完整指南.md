# ğŸ¯ éƒ¨ç½²åç›‘æ§å®Œæ•´æŒ‡å—

## âœ… å·²æ·»åŠ çš„ç›‘æ§åŠŸèƒ½

éƒ¨ç½²ä¿®å¤ä»£ç åï¼Œä½ å°†è·å¾—ä»¥ä¸‹ç›‘æ§èƒ½åŠ›ï¼š

### 1. ğŸŒ HTTP ç›‘æ§ API

**ç«¯ç‚¹ï¼š** `http://your-server:3000/api/monitor/health`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "status": "ok",
  "goroutines": 1234,
  "memory": {
    "alloc_mb": 256,
    "total_alloc_mb": 1024,
    "sys_mb": 512,
    "num_gc": 45
  }
}
```

### 2. ğŸ“ è‡ªåŠ¨æ—¥å¿—è®°å½•

æœåŠ¡ä¼šè‡ªåŠ¨æ¯ 30 ç§’è®°å½•ä¸€æ¬¡ goroutine æ•°é‡ï¼š

```
ğŸŸ¢ æ­£å¸¸æƒ…å†µï¼ˆ< 2000ï¼‰: ä¸è®°å½•ï¼ˆé™¤éå¼€å¯DEBUGï¼‰
ğŸŸ¡ è­¦å‘Šæƒ…å†µï¼ˆ2000-5000ï¼‰: è®°å½•åˆ°æ—¥å¿—
ğŸ”´ å±é™©æƒ…å†µï¼ˆ> 5000ï¼‰: è®°å½•åˆ°é”™è¯¯æ—¥å¿—
```

### 3. ğŸ› ï¸ ç›‘æ§è„šæœ¬

æä¾›äº†å¤šä¸ªç°æˆçš„ç›‘æ§è„šæœ¬ï¼š

| è„šæœ¬ | ç”¨é€” | å¹³å° |
|------|------|------|
| `quick_check.ps1` | å¿«é€Ÿæ£€æŸ¥å½“å‰çŠ¶æ€ | Windows â­ |
| `monitor_goroutines.ps1` | å®æ—¶ç›‘æ§ï¼ˆè‡ªåŠ¨åˆ·æ–°ï¼‰| Windows â­ |
| `monitor_goroutines.sh` | å®æ—¶ç›‘æ§ï¼ˆè‡ªåŠ¨åˆ·æ–°ï¼‰| Linux |
| `test_timeout.sh` | æµ‹è¯•è¶…æ—¶é…ç½® | Linux |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

### æ­¥éª¤ 1: éƒ¨ç½²ä¿®å¤ä»£ç 

```powershell
# Windows PowerShell
cd C:\Users\brows\Desktop\ezlinkai

# ç¼–è¯‘
go build -o one-api.exe

# é‡å¯ Docker
docker-compose down
docker-compose up -d --build
```

### æ­¥éª¤ 2: ç­‰å¾…å¯åŠ¨ï¼ˆçº¦1-2åˆ†é’Ÿï¼‰

```powershell
# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
docker logs -f one-api

# çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºæˆåŠŸï¼š
# âœ… One API v1.x.x started
# âœ… monitoring endpoints enabled at /api/monitor/health
# âœ… key disable notification listener started
```

### æ­¥éª¤ 3: å¼€å§‹ç›‘æ§

**Windows ç”¨æˆ·ï¼ˆæ¨èï¼‰ï¼š**

```powershell
# æ–¹æ³•A: å¿«é€Ÿæ£€æŸ¥
.\quick_check.ps1

# æ–¹æ³•B: å®æ—¶ç›‘æ§æœ¬åœ°
.\monitor_goroutines.ps1

# æ–¹æ³•C: å®æ—¶ç›‘æ§è¿œç¨‹æœåŠ¡å™¨
.\monitor_goroutines.ps1 -ApiUrl "http://your-server-ip:3000" -Interval 5
```

**Linux/Mac ç”¨æˆ·ï¼š**

```bash
# å¿«é€Ÿæ£€æŸ¥
curl http://localhost:3000/api/monitor/health | jq .

# å®æ—¶ç›‘æ§
chmod +x monitor_goroutines.sh
./monitor_goroutines.sh http://localhost:3000 5
```

---

## ğŸ“Š ç›‘æ§ç¤ºä¾‹

### æ­£å¸¸æƒ…å†µï¼ˆä¿®å¤åï¼‰

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  å®æ—¶ç›‘æ§ - [10:30:45] è¿è¡Œæ—¶é•¿: 15åˆ†30ç§’
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Goroutines: 856 ğŸŸ¢ æ­£å¸¸
ğŸ’¾ å†…å­˜åˆ†é…: 345 MB
ğŸ’½ ç³»ç»Ÿå†…å­˜: 512 MB
ğŸ”„ GCæ¬¡æ•°: 23

ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:
   æœ€å¤§å€¼: 1234
   æœ€å°å€¼: 456
   å½“å‰å€¼: 856

âœ… Goroutine æ•°é‡æ­£å¸¸
```

### å¼‚å¸¸æƒ…å†µï¼ˆéœ€è¦å…³æ³¨ï¼‰

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  å®æ—¶ç›‘æ§ - [10:35:00] è¿è¡Œæ—¶é•¿: 20åˆ†15ç§’
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Goroutines: 6543 ğŸ”´ å±é™©
ğŸ’¾ å†…å­˜åˆ†é…: 2048 MB
ğŸ’½ ç³»ç»Ÿå†…å­˜: 3072 MB
ğŸ”„ GCæ¬¡æ•°: 156

ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:
   æœ€å¤§å€¼: 6543
   æœ€å°å€¼: 456
   å½“å‰å€¼: 6543

âš ï¸  è­¦å‘Š: Goroutine æ•°é‡è¶…è¿‡ 5,000
   è¯·æ£€æŸ¥æ—¥å¿—ï¼Œå¯èƒ½å­˜åœ¨å¼‚å¸¸
```

---

## ğŸ” å¦‚ä½•åˆ¤æ–­ä¿®å¤æ˜¯å¦æˆåŠŸï¼Ÿ

### âœ… ä¿®å¤æˆåŠŸçš„æ ‡å¿—

**éƒ¨ç½²å 30 åˆ†é’Ÿå†…ï¼š**
- âœ… Goroutine æ•°é‡ç¨³å®šåœ¨ < 3000
- âœ… å†…å­˜ä½¿ç”¨ç¨³å®šï¼Œä¸æŒç»­å¢é•¿
- âœ… æ—¥å¿—ä¸­ goroutine æ•°é‡åœ¨åˆç†èŒƒå›´æ³¢åŠ¨

**éƒ¨ç½²å 2 å°æ—¶å†…ï¼š**
- âœ… Goroutine å³°å€¼ < 3000
- âœ… æ²¡æœ‰çœ‹åˆ° > 5000 çš„æƒ…å†µ
- âœ… å®¹å™¨æŒç»­è¿è¡Œï¼Œæ²¡æœ‰å´©æºƒ

**éƒ¨ç½²å 24 å°æ—¶ï¼š**
- âœ… Goroutine æ•°é‡é•¿æœŸç¨³å®š
- âœ… å†…å­˜ä½¿ç”¨ç¨³å®š
- âœ… æ²¡æœ‰æ”¶åˆ°å‘Šè­¦

### âŒ ä»æœ‰é—®é¢˜çš„æ ‡å¿—

- âŒ Goroutine æŒç»­å¢é•¿ï¼ˆä» 1000 â†’ 2000 â†’ 3000 â†’ ...ï¼‰
- âŒ å‡ å°æ—¶åè¶…è¿‡ 10000
- âŒ å†…å­˜æŒç»­å¢é•¿
- âŒ å®¹å™¨ä»ç„¶å´©æºƒ

---

## ğŸ“ˆ ç›‘æ§æ—¶é—´è¡¨

### ç¬¬ä¸€å¤©ï¼ˆé‡ç‚¹ç›‘æ§ï¼‰

| æ—¶é—´ç‚¹ | æ“ä½œ | é¢„æœŸç»“æœ |
|--------|------|---------|
| éƒ¨ç½²å 10 åˆ†é’Ÿ | è¿è¡Œ `quick_check.ps1` | Goroutines < 1000 |
| éƒ¨ç½²å 30 åˆ†é’Ÿ | è¿è¡Œ `monitor_goroutines.ps1` è§‚å¯Ÿ5åˆ†é’Ÿ | ç¨³å®šåœ¨ < 2000 |
| éƒ¨ç½²å 1 å°æ—¶ | æ£€æŸ¥æ—¥å¿—æ˜¯å¦æœ‰å‘Šè­¦ | æ— é«˜goroutineå‘Šè­¦ |
| éƒ¨ç½²å 2 å°æ—¶ | è®°å½•å³°å€¼ | å³°å€¼ < 3000 |
| éƒ¨ç½²å 4 å°æ—¶ | æ£€æŸ¥å†…å­˜æ˜¯å¦å¢é•¿ | å†…å­˜ç¨³å®š |
| éƒ¨ç½²å 8 å°æ—¶ | å…¨é¢æ£€æŸ¥ | å„é¡¹æŒ‡æ ‡æ­£å¸¸ |
| éƒ¨ç½²å 24 å°æ—¶ | ç¨³å®šæ€§éªŒè¯ | æŒç»­ç¨³å®šè¿è¡Œ |

### ç¬¬ä¸€å‘¨ï¼ˆå¸¸è§„ç›‘æ§ï¼‰

```powershell
# æ¯å¤©è¿è¡Œä¸€æ¬¡
.\quick_check.ps1

# æˆ–è€…è®¾ç½®è®¡åˆ’ä»»åŠ¡
# ä»»åŠ¡è®¡åˆ’ç¨‹åº â†’ åˆ›å»ºä»»åŠ¡ â†’ æ¯å°æ—¶è¿è¡Œ quick_check.ps1
```

---

## ğŸ› ï¸ Windows è®¡åˆ’ä»»åŠ¡è®¾ç½®

### è®¾ç½®è‡ªåŠ¨ç›‘æ§ï¼ˆå¯é€‰ï¼‰

1. æ‰“å¼€"ä»»åŠ¡è®¡åˆ’ç¨‹åº"
2. åˆ›å»ºåŸºæœ¬ä»»åŠ¡
3. é…ç½®ï¼š
   - **åç§°**: OneAPIç›‘æ§
   - **è§¦å‘å™¨**: æ¯å°æ—¶
   - **æ“ä½œ**: å¯åŠ¨ç¨‹åº
   - **ç¨‹åº**: `powershell.exe`
   - **å‚æ•°**: `-File "C:\Users\brows\Desktop\ezlinkai\quick_check.ps1" >> monitor.log`

---

## ğŸ“ å„ç§ç›‘æ§æ–¹å¼å¯¹æ¯”

| æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåœºæ™¯ |
|------|------|------|---------|
| **HTTP API** | å®æ—¶ã€å‡†ç¡® | éœ€è¦ç½‘ç»œè®¿é—® | â­â­â­â­â­ æœ€æ¨è |
| **è‡ªåŠ¨æ—¥å¿—** | è‡ªåŠ¨è®°å½•ã€æŒä¹…åŒ– | éœ€è¦æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ | â­â­â­â­ è¾…åŠ©ä½¿ç”¨ |
| **Docker stats** | ç³»ç»Ÿçº§ç›‘æ§ | æ— æ³•çœ‹åˆ°goroutine | â­â­â­ é…åˆä½¿ç”¨ |
| **å®æ—¶è„šæœ¬** | ç›´è§‚ã€å½©è‰²æ˜¾ç¤º | éœ€è¦ä¸€ç›´è¿è¡Œ | â­â­â­â­ è°ƒè¯•æ—¶ç”¨ |

---

## ğŸ“ ç›‘æ§æœ€ä½³å®è·µ

### ç¬¬ä¸€å‘¨ï¼ˆå¯†é›†ç›‘æ§ï¼‰

```powershell
# æ¯å¤©3æ¬¡æ£€æŸ¥
.\quick_check.ps1 >> daily_check.log

# æˆ–è€…å®æ—¶ç›‘æ§30åˆ†é’Ÿ
.\monitor_goroutines.ps1 -Interval 10
```

### ç¨³å®šåï¼ˆå¸¸è§„ç›‘æ§ï¼‰

```powershell
# æ¯å‘¨1-2æ¬¡æ£€æŸ¥
.\quick_check.ps1

# æˆ–è€…åªçœ‹æ—¥å¿—
docker logs --tail 100 one-api | Select-String "goroutine"
```

### å‡ºç°é—®é¢˜æ—¶ï¼ˆæ·±åº¦ç›‘æ§ï¼‰

```powershell
# 1. å¼€å¯DEBUGæ¨¡å¼
# ç¼–è¾‘ docker-compose.ymlï¼Œæ·»åŠ  DEBUG=true

# 2. å®æ—¶ç›‘æ§
.\monitor_goroutines.ps1 -Interval 5

# 3. åŒæ—¶æŸ¥çœ‹æ—¥å¿—
docker logs -f one-api

# 4. æ”¶é›†æ•°æ®
docker logs one-api > debug.log
curl http://localhost:3000/api/monitor/health > health.json
```

---

## ğŸ“± æ‰‹æœº/å¤–ç½‘ç›‘æ§

### æ–¹æ³• 1: ä½¿ç”¨ç›‘æ§æœåŠ¡

æ¨èçš„å…è´¹ç›‘æ§æœåŠ¡ï¼š
- **UptimeRobot**: https://uptimerobot.com/
- **Uptime Kuma**: è‡ªå»ºç›‘æ§ï¼ˆæ¨èï¼‰
- **Healthchecks.io**: https://healthchecks.io/

**é…ç½®ç¤ºä¾‹ï¼ˆUptimeRobotï¼‰ï¼š**
```
ç›‘æ§ç±»å‹: HTTP(s)
URL: http://your-server:3000/api/monitor/health
ç›‘æ§é—´éš”: 5åˆ†é’Ÿ
å‘Šè­¦æ¡ä»¶: å…³é”®å­—æ£€æµ‹ "goroutines"
å‘Šè­¦æ–¹å¼: é‚®ä»¶/å¾®ä¿¡/Telegram
```

### æ–¹æ³• 2: ç®€å•çš„å…¬ç½‘è®¿é—®

å¦‚æœæœåŠ¡å™¨æœ‰å…¬ç½‘IPï¼š

```powershell
# ä»æ‰‹æœºæµè§ˆå™¨è®¿é—®
http://your-public-ip:3000/api/monitor/health

# æˆ–è€…ä½¿ç”¨åœ¨çº¿JSONæ ¼å¼åŒ–å·¥å…·
https://jsonformatter.org/
```

---

## ğŸ”” å‘Šè­¦é…ç½®å»ºè®®

### å‘Šè­¦çº§åˆ«è®¾ç½®

```powershell
# è„šæœ¬åŒ–å‘Šè­¦ï¼ˆå¯åŠ å…¥è®¡åˆ’ä»»åŠ¡ï¼‰
$health = Invoke-RestMethod "http://localhost:3000/api/monitor/health"
$goroutines = $health.goroutines

if ($goroutines -gt 10000) {
    # ä¸¥é‡å‘Šè­¦ - å‘é€ç´§æ€¥é€šçŸ¥
    Send-MailMessage -Subject "ğŸ”´ OneAPIä¸¥é‡å‘Šè­¦" -Body "Goroutines: $goroutines"
} elseif ($goroutines -gt 5000) {
    # ä¸€èˆ¬å‘Šè­¦ - å‘é€è­¦å‘Šé€šçŸ¥
    Send-MailMessage -Subject "ğŸŸ¡ OneAPIè­¦å‘Š" -Body "Goroutines: $goroutines"
}
```

---

## ğŸ“Š æ•°æ®è®°å½•å»ºè®®

### å»ºç«‹åŸºå‡†çº¿ï¼ˆç¬¬ä¸€å¤©ï¼‰

```powershell
# è®°å½•ç¬¬ä¸€å¤©çš„æ•°æ®
for ($i=0; $i -lt 24; $i++) {
    $time = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $data = Invoke-RestMethod "http://localhost:3000/api/monitor/health"
    "$time - Goroutines: $($data.goroutines)" | Out-File -Append baseline.txt
    Start-Sleep 3600  # æ¯å°æ—¶ä¸€æ¬¡
}
```

### å¯¹æ¯”ä¿®å¤æ•ˆæœ

```powershell
# æŸ¥çœ‹è¶‹åŠ¿
Get-Content baseline.txt

# åˆ†æ
# ä¿®å¤å‰: æŒç»­å¢é•¿ï¼ˆ1000 â†’ 5000 â†’ 10000 â†’ ... â†’ 169000ï¼‰
# ä¿®å¤å: ç¨³å®šæ³¢åŠ¨ï¼ˆ800 â†’ 1200 â†’ 900 â†’ 1500 â†’ 1100ï¼‰
```

---

## ğŸ’¡ å¸¸è§ç›‘æ§åœºæ™¯

### åœºæ™¯ 1: åˆšéƒ¨ç½²ï¼ŒéªŒè¯ä¿®å¤æ•ˆæœ

```powershell
# ç«‹å³æŸ¥çœ‹
.\quick_check.ps1

# æŒç»­ç›‘æ§30åˆ†é’Ÿ
.\monitor_goroutines.ps1 -Interval 5

# é¢„æœŸ: Goroutines åº”è¯¥ç¨³å®šåœ¨ < 2000
```

### åœºæ™¯ 2: é«˜å³°æœŸç›‘æ§

```powershell
# ä¸šåŠ¡é«˜å³°æœŸå‰å¼€å§‹ç›‘æ§
.\monitor_goroutines.ps1 -Interval 10

# è§‚å¯Ÿå³°å€¼æ˜¯å¦åœ¨åˆç†èŒƒå›´
# é«˜å³°æœŸ 3000-5000 æ˜¯å¯æ¥å—çš„
```

### åœºæ™¯ 3: æ€€ç–‘æœ‰é—®é¢˜

```powershell
# 1. ç«‹å³æ£€æŸ¥
.\quick_check.ps1

# 2. æŸ¥çœ‹æœ€è¿‘çš„æ—¥å¿—
docker logs --tail 200 one-api | Select-String "goroutine|error|panic"

# 3. å¼€å¯å®æ—¶ç›‘æ§
.\monitor_goroutines.ps1 -Interval 3

# 4. å¦‚æœç¡®è®¤æœ‰é—®é¢˜ï¼Œæ”¶é›†æ•°æ®
docker logs one-api > problem_$(Get-Date -Format 'yyyyMMdd_HHmmss').log
```

### åœºæ™¯ 4: è¿œç¨‹ç›‘æ§ç”Ÿäº§æœåŠ¡å™¨

```powershell
# ç›‘æ§è¿œç¨‹æœåŠ¡å™¨
.\monitor_goroutines.ps1 -ApiUrl "http://prod-server-ip:3000" -Interval 10

# æˆ–è€…é€šè¿‡ SSH éš§é“
ssh -L 3000:localhost:3000 user@prod-server
.\monitor_goroutines.ps1
```

---

## ğŸ¯ ç›‘æ§æ£€æŸ¥æ¸…å•

### æ¯æ—¥æ£€æŸ¥ï¼ˆ1åˆ†é’Ÿï¼‰

```powershell
# âœ… è¿è¡Œå¿«é€Ÿæ£€æŸ¥
.\quick_check.ps1

# âœ… æŸ¥çœ‹ Docker çŠ¶æ€
docker ps | Select-String one-api

# âœ… æ£€æŸ¥é‡å¯æ¬¡æ•°ï¼ˆåº”è¯¥æ˜¯0ï¼‰
docker inspect one-api --format='{{.RestartCount}}'
```

### æ¯å‘¨æ£€æŸ¥ï¼ˆ5åˆ†é’Ÿï¼‰

```powershell
# âœ… æŸ¥çœ‹ä¸€å‘¨çš„æ—¥å¿—
docker logs --since 168h one-api | Select-String "High goroutine"

# âœ… æ£€æŸ¥å†…å­˜è¶‹åŠ¿
docker stats one-api --no-stream

# âœ… è¿è¡Œå®æ—¶ç›‘æ§è§‚å¯Ÿ5åˆ†é’Ÿ
.\monitor_goroutines.ps1 -Interval 10
```

### æ¯æœˆæ£€æŸ¥ï¼ˆ10åˆ†é’Ÿï¼‰

```powershell
# âœ… å…¨é¢å¥åº·æ£€æŸ¥
.\quick_check.ps1
docker stats one-api --no-stream
docker logs --tail 500 one-api | Select-String "error"

# âœ… æ€§èƒ½åŸºå‡†å¯¹æ¯”
# å¯¹æ¯”å½“å‰æ•°æ®å’Œç¬¬ä¸€å¤©çš„ baseline.txt
```

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡

éƒ¨ç½²ä¿®å¤åï¼ŒæˆåŠŸçš„æ ‡å¿—ï¼š

### ç¬¬1å¤©
```
âœ… Goroutine: 500-2000 (ç¨³å®š)
âœ… å†…å­˜: < 1GB (ç¨³å®š)
âœ… å®¹å™¨: æŒç»­è¿è¡Œ
âœ… æ—¥å¿—: æ— ä¸¥é‡å‘Šè­¦
```

### ç¬¬1å‘¨
```
âœ… Goroutineå³°å€¼: < 3000
âœ… å¹³å‡å€¼: 1000-1500
âœ… å†…å­˜å¢é•¿: æ— 
âœ… å®¹å™¨é‡å¯: 0æ¬¡
```

### ç¬¬1æœˆ
```
âœ… é•¿æœŸç¨³å®šè¿è¡Œ
âœ… Goroutine æ— æŒç»­å¢é•¿è¶‹åŠ¿
âœ… æ— éœ€é¢‘ç¹é‡å¯
```

---

## ğŸš¨ å¼‚å¸¸å¤„ç†æµç¨‹

### å‘ç° Goroutine > 5000

```powershell
# 1. ç«‹å³æ£€æŸ¥è¯¦ç»†ä¿¡æ¯
.\quick_check.ps1
docker logs --tail 200 one-api

# 2. æŸ¥æ‰¾å¼‚å¸¸æ¨¡å¼
docker logs --tail 500 one-api | Select-String "error|timeout|panic"

# 3. è¯†åˆ«é—®é¢˜æ¸ é“
docker logs --tail 500 one-api | Select-String "relay error"

# 4. ä¸´æ—¶ç¦ç”¨é—®é¢˜æ¸ é“ï¼ˆå¦‚æœæ‰¾åˆ°ï¼‰
# é€šè¿‡Webç•Œé¢ç¦ç”¨å¯¹åº”æ¸ é“

# 5. å¦‚æœæŒç»­å¢é•¿ï¼Œè€ƒè™‘é‡å¯
docker-compose restart one-api
```

### å‘ç° Goroutine > 10000

```powershell
# ç«‹å³æ“ä½œï¼š
# 1. æ”¶é›†è¯Šæ–­æ•°æ®
docker logs one-api > emergency_$(Get-Date -Format 'yyyyMMdd_HHmmss').log
.\quick_check.ps1 > health_$(Get-Date -Format 'yyyyMMdd_HHmmss').json

# 2. é‡å¯æœåŠ¡
docker-compose restart one-api

# 3. é‡å¯åç«‹å³ç›‘æ§
.\monitor_goroutines.ps1 -Interval 5

# 4. å¦‚æœé—®é¢˜é‡ç°ï¼Œè¯´æ˜å¯èƒ½è¿˜æœ‰å…¶ä»–æ³„æ¼ç‚¹
# æä¾›æ—¥å¿—æ–‡ä»¶è¿›è¡Œåˆ†æ
```

---

## ğŸ‰ æ€»ç»“

ç°åœ¨ä½ æœ‰äº†å®Œæ•´çš„ç›‘æ§ä½“ç³»ï¼š

1. âœ… **å®æ—¶ API** - éšæ—¶æŸ¥çœ‹å½“å‰çŠ¶æ€
2. âœ… **è‡ªåŠ¨æ—¥å¿—** - åå°æŒç»­è®°å½•
3. âœ… **ç›‘æ§è„šæœ¬** - å¯è§†åŒ–å±•ç¤º
4. âœ… **å‘Šè­¦æœºåˆ¶** - å¼‚å¸¸åŠæ—¶å‘ç°

**éƒ¨ç½²åç«‹å³å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼**

---

## ğŸ”§ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```powershell
# ==================== Windows PowerShell ====================

# å¿«é€Ÿæ£€æŸ¥
.\quick_check.ps1

# å®æ—¶ç›‘æ§
.\monitor_goroutines.ps1

# ç›‘æ§è¿œç¨‹
.\monitor_goroutines.ps1 -ApiUrl "http://server:3000"

# æŸ¥çœ‹æ—¥å¿—
docker logs -f one-api

# æŸ¥çœ‹èµ„æº
docker stats one-api --no-stream

# ==================== é€šè¿‡ HTTP API ====================

# è·å–çŠ¶æ€
curl http://localhost:3000/api/monitor/health

# åªçœ‹ goroutine æ•°é‡ï¼ˆéœ€è¦ jqï¼‰
curl -s http://localhost:3000/api/monitor/health | jq .goroutines

# ==================== Docker å‘½ä»¤ ====================

# æŸ¥çœ‹æ—¥å¿—ä¸­çš„ goroutine è®°å½•
docker logs one-api | Select-String "goroutine"

# æŸ¥çœ‹æœ€è¿‘çš„å‘Šè­¦
docker logs --tail 100 one-api | Select-String "High goroutine"

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps | Select-String one-api

# é‡å¯æœåŠ¡
docker-compose restart one-api
```

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿéƒ¨ç½²åç«‹å³å¼€å§‹ç›‘æ§ï¼** ğŸš€

